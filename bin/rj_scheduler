#!/bin/env ruby
require 'pathname'
require 'bundler/setup'
require 'rake'

rails_root = Pathname.new(Dir.getwd)
ENV['RAILS_ROOT'] = rails_root.to_s
ENV['RAILS_ENV'] ||= 'development'

require File.expand_path('../../lib/rabbit_jobs/tasks', __FILE__)

case ARGV.first
when 'start'
  require 'bundler/setup'
  require rails_root.join('config/application')
  Rake::Task['rj:scheduler:start'].invoke
when 'stop'
  Rake::Task['rj:scheduler:stop'].invoke
when 'status'
  Rake::Task['rj:scheduler:status'].invoke
else
  raise "usage: rj_scheduler <start>|<stop>|<status>"
end